# DataExplorer é‡æ„ç‰ˆæœ¬ - å¿«é€Ÿä¸Šæ‰‹

## ğŸ‰ é‡æ„å®Œæˆ

åŸ2555è¡Œçš„ `DataExplorer.vue` å·²æˆåŠŸé‡æ„ä¸ºæ¨¡å—åŒ–ç»„ä»¶ç³»ç»Ÿ!

---

## ğŸš€ ç«‹å³å¼€å§‹

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
cd manager/frontend
npm install  # å¦‚æœè¿˜æ²¡å®‰è£…ä¾èµ–
npm run dev
```

è®¿é—®: http://localhost:5174

### 2. æŸ¥çœ‹æ•ˆæœ

æ—§ç‰ˆæœ¬å·²å¤‡ä»½ä¸º `DataExplorer_old.vue`,æ–°ç‰ˆæœ¬å·²ç”Ÿæ•ˆ!

---

## ğŸ“ æ–°æ¶æ„ä¸€è§ˆ

```
src/
â”œâ”€â”€ views/
â”‚   â””â”€â”€ DataExplorer.vue          162è¡Œ âœ¨ ä¸»ç»„ä»¶(ç²¾ç®€90%ä»£ç )
â”‚
â”œâ”€â”€ composables/                  å¯å¤ç”¨é€»è¾‘å±‚
â”‚   â”œâ”€â”€ useMapConfig.js           åœ°å›¾é…ç½®
â”‚   â”œâ”€â”€ useGaodeMap.js            é«˜å¾·åœ°å›¾
â”‚   â”œâ”€â”€ useOpenLayersMap.js       OpenLayers
â”‚   â””â”€â”€ useResizable.js           æ‹–æ‹½è°ƒæ•´
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ map/                      åœ°å›¾ç»„ä»¶å±‚
â”‚   â”‚   â”œâ”€â”€ MapContainer.vue      åœ°å›¾å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ GaodeMapRenderer.vue  é«˜å¾·æ¸²æŸ“å™¨
â”‚   â”‚   â””â”€â”€ OpenLayersRenderer.vue  OLæ¸²æŸ“å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ previews/                 é¢„è§ˆç»„ä»¶å±‚
â”‚   â”‚   â”œâ”€â”€ TablePreview.vue      è¡¨æ ¼+åœ°å›¾é¢„è§ˆ
â”‚   â”‚   â”œâ”€â”€ ObjectStoragePreview.vue  å¯¹è±¡å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ GeoJsonPreview.vue    GeoJSON+åœ°å›¾
â”‚   â”‚   â”œâ”€â”€ ImagePreview.vue      å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ JsonPreview.vue       JSON
â”‚   â”‚   â””â”€â”€ TextPreview.vue       æ–‡æœ¬
â”‚   â”‚
â”‚   â””â”€â”€ explorer/                 åŸºç¡€ç»„ä»¶å±‚
â”‚       â”œâ”€â”€ ResourceTree.vue      èµ„æºæ ‘
â”‚       â”œâ”€â”€ PreviewPanel.vue      é¢„è§ˆé¢æ¿
â”‚       â””â”€â”€ Splitter.vue          åˆ†éš”å™¨
â”‚
â”œâ”€â”€ plugins/previews/             æ’ä»¶ç³»ç»Ÿ ğŸ”Œ
â”‚   â””â”€â”€ index.js                  è‡ªåŠ¨è·¯ç”±åˆ°åˆé€‚çš„é¢„è§ˆç»„ä»¶
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ formatters.js             æ ¼å¼åŒ–å·¥å…·
    â””â”€â”€ treeTransform.js          æ ‘è½¬æ¢
```

---

## ğŸ”Œ æœ€æ¿€åŠ¨äººå¿ƒçš„ç‰¹æ€§: æ’ä»¶åŒ–é¢„è§ˆç³»ç»Ÿ

### æ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç ,å³å¯æ·»åŠ æ–°æ–‡ä»¶ç±»å‹æ”¯æŒ!

#### ç¤ºä¾‹: æ·»åŠ  CSV é¢„è§ˆ

**æ­¥éª¤1**: åˆ›å»ºæ’ä»¶æ–‡ä»¶ `public/plugins/my-csv-preview.js`

```javascript
window.DataExplorerPlugins = window.DataExplorerPlugins || []

window.DataExplorerPlugins.push({
  name: 'csv',
  component: {
    template: `
      <el-table :data="rows">
        <el-table-column v-for="col in columns" :key="col" :prop="col" :label="col"/>
      </el-table>
    `,
    props: ['data'],
    computed: {
      rows() {
        // è§£æ CSV
        const text = this.data.object?.content?.text || ''
        return parseCSV(text)
      }
    }
  },
  canHandle: (data) => data.object?.path?.endsWith('.csv'),
  priority: 50
})
```

**æ­¥éª¤2**: åœ¨ `index.html` å¼•å…¥

```html
<script src="/plugins/my-csv-preview.js"></script>
```

**å®Œæˆ!** ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä½¿ç”¨ä½ çš„æ’ä»¶!

æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹: [example-csv-preview.js](public/plugins/example-csv-preview.js)

---

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›

| æ–¹é¢ | æ—§ç‰ˆ | æ–°ç‰ˆ |
|------|------|------|
| **ä»£ç è¡Œæ•°** | 2555è¡Œå•æ–‡ä»¶ | ~2400è¡Œåˆ†å¸ƒåœ¨21ä¸ªæ–‡ä»¶ |
| **å¹³å‡æ–‡ä»¶å¤§å°** | N/A | ~115è¡Œ/æ–‡ä»¶ |
| **å¯ç»´æŠ¤æ€§** | âŒ éš¾ä»¥å®šä½é—®é¢˜ | âœ… èŒè´£æ¸…æ™° |
| **å¯æ‰©å±•æ€§** | âŒ ä¿®æ”¹æ ¸å¿ƒä»£ç  | âœ… æ’ä»¶åŒ–ç³»ç»Ÿ |
| **å¯æµ‹è¯•æ€§** | âŒ éš¾ä»¥å•å…ƒæµ‹è¯• | âœ… ç»„ä»¶ç‹¬ç«‹å¯æµ‹ |
| **æ€§èƒ½** | âš ï¸  å…¨é‡åŠ è½½ | âœ… å¯æŒ‰éœ€åŠ è½½ |

---

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµ

### ä¿®æ”¹é¢„è§ˆé€»è¾‘

**æ—§ç‰ˆ**: éœ€è¦åœ¨2555è¡Œä¸­æ‰¾åˆ°å¯¹åº”é€»è¾‘,å°å¿ƒä¸ç ´åå…¶ä»–åŠŸèƒ½

**æ–°ç‰ˆ**: ç›´æ¥ä¿®æ”¹å¯¹åº”ç»„ä»¶

```bash
# ä¿®æ”¹è¡¨æ ¼é¢„è§ˆ
vim src/components/previews/TablePreview.vue

# ä¿®æ”¹åœ°å›¾æ¸²æŸ“
vim src/components/map/GaodeMapRenderer.vue

# ä¿®æ”¹æ ¼å¼åŒ–å·¥å…·
vim src/utils/formatters.js
```

### æ·»åŠ æ–°åŠŸèƒ½

**æ—§ç‰ˆ**: åœ¨å·¨å‹æ–‡ä»¶ä¸­æ’å…¥ä»£ç ,å¯èƒ½å¼•å‘æ„å¤–bug

**æ–°ç‰ˆ**: åˆ›å»ºæ–°ç»„ä»¶æˆ–æ’ä»¶

```bash
# æ–¹å¼1: åˆ›å»ºå†…ç½®ç»„ä»¶
cp src/components/previews/TextPreview.vue src/components/previews/MarkdownPreview.vue
# ä¿®æ”¹åæ³¨å†Œåˆ° plugins/previews/index.js

# æ–¹å¼2: åˆ›å»ºç”¨æˆ·æ’ä»¶
vim public/plugins/markdown-preview.js
# åœ¨ index.html å¼•å…¥å³å¯
```

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- **[REFACTOR_SUMMARY.md](REFACTOR_SUMMARY.md)** - é‡æ„æ€»ç»“å’Œå¯¹æ¯”
- **[REFACTOR_PLAN.md](REFACTOR_PLAN.md)** - å®Œæ•´é‡æ„æ–¹æ¡ˆ
- **[public/plugins/README.md](public/plugins/README.md)** - æ’ä»¶å¼€å‘æŒ‡å—

---

## âœ… åŠŸèƒ½éªŒè¯æ¸…å•

å¯åŠ¨é¡¹ç›®å,è¯·éªŒè¯ä»¥ä¸‹åŠŸèƒ½:

### åŸºç¡€åŠŸèƒ½
- [ ] å·¦ä¾§èµ„æºæ ‘æ­£å¸¸åŠ è½½
- [ ] ç‚¹å‡»æ ‘èŠ‚ç‚¹åˆ‡æ¢é¢„è§ˆ
- [ ] æ‹–æ‹½è°ƒæ•´æ ‘å®½åº¦

### è¡¨æ ¼é¢„è§ˆ
- [ ] æ˜¾ç¤ºè¡¨æ ¼æ•°æ®
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸
- [ ] GeoJSONå­—æ®µè‡ªåŠ¨æ˜¾ç¤ºåœ°å›¾
- [ ] åœ°å›¾å’Œè¡¨æ ¼è”åŠ¨(ç‚¹å‡»è¦ç´ é«˜äº®è¡Œ)

### å¯¹è±¡å­˜å‚¨é¢„è§ˆ
- [ ] æ˜¾ç¤ºbucket/ç›®å½•/æ–‡ä»¶å…ƒæ•°æ®
- [ ] åŒå‡»ç›®å½•è¿›å…¥
- [ ] æ–‡ä»¶å†…å®¹é¢„è§ˆ:
  - [ ] å›¾ç‰‡ (.png, .jpg)
  - [ ] JSON (.json)
  - [ ] GeoJSON (.geojson) + åœ°å›¾
  - [ ] æ–‡æœ¬ (.txt)

### åœ°å›¾åŠŸèƒ½
- [ ] é«˜å¾·åœ°å›¾åº•å›¾
- [ ] å¤©åœ°å›¾çŸ¢é‡åº•å›¾
- [ ] å¤©åœ°å›¾å½±åƒåº•å›¾
- [ ] åˆ‡æ¢åº•å›¾è§†è§’ä¿æŒ
- [ ] ç‚¹å‡»è¦ç´ æ˜¾ç¤ºå¼¹çª—

---

## ğŸ› é‡åˆ°é—®é¢˜?

### å¸¸è§é—®é¢˜

**Q: æ„å»ºå¤±è´¥,æç¤ºæ‰¾ä¸åˆ°æ¨¡å—?**
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install
```

**Q: åœ°å›¾ä¸æ˜¾ç¤º?**
- æ£€æŸ¥æ˜¯å¦é…ç½®äº†åœ°å›¾Key (é«˜å¾·/å¤©åœ°å›¾)
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

**Q: è‡ªå®šä¹‰æ’ä»¶ä¸ç”Ÿæ•ˆ?**
- æ£€æŸ¥ `index.html` æ˜¯å¦æ­£ç¡®å¼•å…¥äº†æ’ä»¶æ–‡ä»¶
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ `âœ… æ³¨å†Œé¢„è§ˆæ’ä»¶: xxx` æ—¥å¿—
- ç¡®è®¤ `canHandle` å‡½æ•°è¿”å› `true`

### è°ƒè¯•æŠ€å·§

```javascript
// 1. æŸ¥çœ‹å·²æ³¨å†Œçš„æ’ä»¶
import('@/plugins/previews').then(m => {
  console.log('å·²æ³¨å†Œæ’ä»¶:', m.getRegisteredPlugins())
})

// 2. æµ‹è¯• canHandle å‡½æ•°
const testData = { object: { path: 'test.csv' } }
const plugin = window.DataExplorerPlugins[0]
console.log('èƒ½å¦å¤„ç†:', plugin.canHandle(testData))

// 3. æŸ¥çœ‹é€‰ä¸­çš„ç»„ä»¶
// æ‰“å¼€ Vue DevTools,æŸ¥çœ‹ PreviewPanel ç»„ä»¶çš„ previewComponent å±æ€§
```

---

## ğŸ“ å­¦ä¹ å»ºè®®

### æ–°æ‰‹å…¥é—¨è·¯å¾„

1. **å…ˆç†è§£æ•´ä½“æ¶æ„** (10åˆ†é’Ÿ)
   - é˜…è¯» [REFACTOR_SUMMARY.md](REFACTOR_SUMMARY.md)
   - æŸ¥çœ‹æ–‡ä»¶ç»“æ„

2. **è¿è¡Œå¹¶æµ‹è¯•** (20åˆ†é’Ÿ)
   - å¯åŠ¨é¡¹ç›®
   - æµ‹è¯•å„ç§é¢„è§ˆåŠŸèƒ½
   - å°è¯•è°ƒæ•´é¢æ¿å¤§å°

3. **ä¿®æ”¹ä¸€ä¸ªç®€å•ç»„ä»¶** (30åˆ†é’Ÿ)
   - ä¿®æ”¹ `TextPreview.vue`,æ”¹å˜æ ·å¼
   - ä¿®æ”¹ `formatters.js`,æ”¹å˜æ—¥æœŸæ ¼å¼

4. **åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ’ä»¶** (1å°æ—¶)
   - å‚è€ƒ [example-csv-preview.js](public/plugins/example-csv-preview.js)
   - åˆ›å»ºè‡ªå·±çš„æ’ä»¶
   - æµ‹è¯•æ•ˆæœ

### è¿›é˜¶å¼€å‘è·¯å¾„

1. **æ·±å…¥ç†è§£ Composables** (2å°æ—¶)
   - é˜…è¯» `useGaodeMap.js` æºç 
   - ç†è§£åœ°å›¾çŠ¶æ€ç®¡ç†

2. **åˆ›å»ºå¤æ‚é¢„è§ˆç»„ä»¶** (4å°æ—¶)
   - å‚è€ƒ `TablePreview.vue`
   - åˆ›å»ºå¸¦äº¤äº’çš„é¢„è§ˆç»„ä»¶

3. **ä¼˜åŒ–æ€§èƒ½** (åŠå¤©)
   - å®ç°é¢„è§ˆç»„ä»¶æ‡’åŠ è½½
   - ä¼˜åŒ–åœ°å›¾æ¸²æŸ“æ€§èƒ½

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯åš

1. âœ… å¯åŠ¨é¡¹ç›®éªŒè¯åŠŸèƒ½
2. âœ… åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ’ä»¶
3. âœ… é˜…è¯»è¯¦ç»†æ–‡æ¡£

### ä¸­æœŸè®¡åˆ’

1. ä¸ºç»„ä»¶ç¼–å†™å•å…ƒæµ‹è¯•
2. æ·»åŠ æ›´å¤šæ–‡ä»¶ç±»å‹æ”¯æŒ(PDF, Excel, Video)
3. å®ç°æ’ä»¶é…ç½®UI

### é•¿æœŸè§„åˆ’

1. å‘å¸ƒå®˜æ–¹æ’ä»¶å¸‚åœº
2. æ”¯æŒNPMåŒ…å½¢å¼çš„æ’ä»¶
3. é›†æˆåˆ° Storybook

---

## ğŸ“ éœ€è¦å¸®åŠ©?

- æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: [REFACTOR_PLAN.md](REFACTOR_PLAN.md)
- æ’ä»¶å¼€å‘æŒ‡å—: [public/plugins/README.md](public/plugins/README.md)
- æäº¤Issueåˆ°é¡¹ç›®ä»“åº“

---

**ç¥å¼€å‘æ„‰å¿«! ğŸ‰**
