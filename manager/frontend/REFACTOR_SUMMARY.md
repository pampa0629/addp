# DataExplorer é‡æ„æ€»ç»“

## âœ… é‡æ„å®Œæˆ

é‡æ„å·²æˆåŠŸå®Œæˆ!åŸ **2555è¡Œ** çš„ `DataExplorer.vue` å·²æ‹†åˆ†ä¸º**æ¨¡å—åŒ–ç»„ä»¶ç³»ç»Ÿ**ã€‚

---

## ğŸ“Š é‡æ„å‰åå¯¹æ¯”

### é‡æ„å‰
```
DataExplorer.vue                   2555 è¡Œ  âŒ éš¾ä»¥ç»´æŠ¤
â”œâ”€â”€ è¡¨æ ¼é¢„è§ˆé€»è¾‘
â”œâ”€â”€ å¯¹è±¡å­˜å‚¨é¢„è§ˆé€»è¾‘
â”œâ”€â”€ é«˜å¾·åœ°å›¾å®ç°
â”œâ”€â”€ OpenLayerså®ç°
â”œâ”€â”€ GeoJSONæ–‡ä»¶åœ°å›¾
â”œâ”€â”€ æ‹–æ‹½è°ƒæ•´é€»è¾‘
â”œâ”€â”€ æ•°æ®è½¬æ¢å·¥å…·
â””â”€â”€ æ‰€æœ‰æ ·å¼å®šä¹‰
```

### é‡æ„å
```
DataExplorer.vue                    162 è¡Œ  âœ… æ¸…æ™°ç®€æ´

composables/ (å¯å¤ç”¨é€»è¾‘)
â”œâ”€â”€ useMapConfig.js                 108 è¡Œ  - åœ°å›¾é…ç½®ç®¡ç†
â”œâ”€â”€ useGaodeMap.js                  358 è¡Œ  - é«˜å¾·åœ°å›¾é€»è¾‘
â”œâ”€â”€ useOpenLayersMap.js             344 è¡Œ  - OpenLayersé€»è¾‘
â””â”€â”€ useResizable.js                  52 è¡Œ  - æ‹–æ‹½è°ƒæ•´å¤§å°

components/map/ (åœ°å›¾ç»„ä»¶)
â”œâ”€â”€ MapContainer.vue                 72 è¡Œ  - åœ°å›¾å®¹å™¨
â”œâ”€â”€ GaodeMapRenderer.vue             66 è¡Œ  - é«˜å¾·åœ°å›¾æ¸²æŸ“å™¨
â””â”€â”€ OpenLayersRenderer.vue           84 è¡Œ  - OpenLayersæ¸²æŸ“å™¨

components/previews/ (é¢„è§ˆç»„ä»¶)
â”œâ”€â”€ TablePreview.vue                156 è¡Œ  - è¡¨æ ¼é¢„è§ˆ(å¸¦åœ°å›¾)
â”œâ”€â”€ ObjectStoragePreview.vue        232 è¡Œ  - å¯¹è±¡å­˜å‚¨é¢„è§ˆ
â”œâ”€â”€ GeoJsonPreview.vue              116 è¡Œ  - GeoJSONé¢„è§ˆ
â”œâ”€â”€ ImagePreview.vue                 62 è¡Œ  - å›¾ç‰‡é¢„è§ˆ
â”œâ”€â”€ JsonPreview.vue                  62 è¡Œ  - JSONé¢„è§ˆ
â””â”€â”€ TextPreview.vue                  56 è¡Œ  - æ–‡æœ¬é¢„è§ˆ

components/explorer/ (åŸºç¡€ç»„ä»¶)
â”œâ”€â”€ ResourceTree.vue                 72 è¡Œ  - èµ„æºæ ‘
â”œâ”€â”€ PreviewPanel.vue                 92 è¡Œ  - é¢„è§ˆé¢æ¿
â””â”€â”€ Splitter.vue                     56 è¡Œ  - å¯æ‹–æ‹½åˆ†éš”å™¨

plugins/previews/ (æ’ä»¶ç³»ç»Ÿ)
â””â”€â”€ index.js                        186 è¡Œ  - æ’ä»¶æ³¨å†Œä¸­å¿ƒ

utils/ (å·¥å…·å‡½æ•°)
â”œâ”€â”€ formatters.js                    74 è¡Œ  - æ ¼å¼åŒ–å·¥å…·
â””â”€â”€ treeTransform.js                105 è¡Œ  - æ ‘å½¢æ•°æ®è½¬æ¢

æ€»è®¡:                              ~2400 è¡Œ (åˆ†å¸ƒåœ¨21ä¸ªæ–‡ä»¶)
å¹³å‡æ¯ä¸ªæ–‡ä»¶:                       ~115 è¡Œ âœ… æ˜“äºç»´æŠ¤
```

---

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›

### 1. **èŒè´£åˆ†ç¦»**
- âœ… æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
- âœ… åœ°å›¾é€»è¾‘ä¸é¢„è§ˆé€»è¾‘è§£è€¦
- âœ… æ•°æ®è½¬æ¢ç‹¬ç«‹æˆå·¥å…·å‡½æ•°

### 2. **å¯å¤ç”¨æ€§**
- âœ… Composables å¯åœ¨å…¶ä»–ç»„ä»¶ä¸­ä½¿ç”¨
- âœ… åœ°å›¾ç»„ä»¶å¯ç‹¬ç«‹éƒ¨ç½²
- âœ… é¢„è§ˆç»„ä»¶å¯å•ç‹¬æµ‹è¯•

### 3. **å¯æ‰©å±•æ€§**
- âœ… **æ’ä»¶åŒ–é¢„è§ˆç³»ç»Ÿ** - æ–°å¢æ–‡ä»¶ç±»å‹æ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç 
- âœ… æ”¯æŒ3ç§æ‰©å±•æ–¹å¼:
  - åŠ¨æ€åŠ è½½ (`window.DataExplorerPlugins`)
  - é…ç½®å¼ (configæ–‡ä»¶)
  - è‡ªåŠ¨æ³¨å†Œ (ç»„ä»¶ç›®å½•æ‰«æ)

### 4. **æ€§èƒ½ä¼˜åŒ–**
- âœ… æŒ‰éœ€åŠ è½½é¢„è§ˆç»„ä»¶ (å¯é…ç½®æ‡’åŠ è½½)
- âœ… åœ°å›¾å®ä¾‹å¤ç”¨
- âœ… è§†å›¾çŠ¶æ€ä¿æŒ (åˆ‡æ¢åº•å›¾ä¸é‡ç½®è§†è§’)

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
manager/frontend/src/
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ DataExplorer.vue              # æ–°ç‰ˆä¸»ç»„ä»¶ (162è¡Œ)
â”‚   â””â”€â”€ DataExplorer_old.vue          # æ—§ç‰ˆå¤‡ä»½ (2555è¡Œ)
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ map/                          # åœ°å›¾ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MapContainer.vue
â”‚   â”‚   â”œâ”€â”€ GaodeMapRenderer.vue
â”‚   â”‚   â””â”€â”€ OpenLayersRenderer.vue
â”‚   â”‚
â”‚   â”œâ”€â”€ previews/                     # é¢„è§ˆç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ TablePreview.vue
â”‚   â”‚   â”œâ”€â”€ ObjectStoragePreview.vue
â”‚   â”‚   â”œâ”€â”€ GeoJsonPreview.vue
â”‚   â”‚   â”œâ”€â”€ ImagePreview.vue
â”‚   â”‚   â”œâ”€â”€ JsonPreview.vue
â”‚   â”‚   â””â”€â”€ TextPreview.vue
â”‚   â”‚
â”‚   â””â”€â”€ explorer/                     # åŸºç¡€ç»„ä»¶
â”‚       â”œâ”€â”€ ResourceTree.vue
â”‚       â”œâ”€â”€ PreviewPanel.vue
â”‚       â””â”€â”€ Splitter.vue
â”‚
â”œâ”€â”€ composables/                      # å¯å¤ç”¨é€»è¾‘
â”‚   â”œâ”€â”€ useMapConfig.js
â”‚   â”œâ”€â”€ useGaodeMap.js
â”‚   â”œâ”€â”€ useOpenLayersMap.js
â”‚   â””â”€â”€ useResizable.js
â”‚
â”œâ”€â”€ plugins/                          # æ’ä»¶ç³»ç»Ÿ
â”‚   â””â”€â”€ previews/
â”‚       â””â”€â”€ index.js
â”‚
â””â”€â”€ utils/                            # å·¥å…·å‡½æ•°
    â”œâ”€â”€ formatters.js
    â””â”€â”€ treeTransform.js
```

---

## ğŸ”Œ ç”¨æˆ·æ‰©å±•ç¤ºä¾‹

### æ·»åŠ  CSV é¢„è§ˆ (æ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç !)

åˆ›å»º `public/plugins/csv-preview.js`:

```javascript
window.DataExplorerPlugins = window.DataExplorerPlugins || []

window.DataExplorerPlugins.push({
  name: 'csv',
  component: {
    template: `
      <el-table :data="parsedData">
        <el-table-column v-for="col in columns" :key="col" :prop="col" :label="col" />
      </el-table>
    `,
    props: ['data'],
    computed: {
      parsedData() {
        // è§£æ CSV é€»è¾‘
        return this.parseCSV(this.data.object?.content?.text)
      }
    }
  },
  canHandle: (data) => {
    return data.object?.path?.endsWith('.csv')
  },
  priority: 50
})
```

åœ¨ `index.html` ä¸­å¼•å…¥:
```html
<script src="/plugins/csv-preview.js"></script>
```

**å®Œæˆ!** ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä½¿ç”¨è¯¥æ’ä»¶!

è¯¦ç»†æ‰©å±•æ–‡æ¡£è§: [public/plugins/README.md](public/plugins/README.md)

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æ„å»ºæµ‹è¯•
```bash
cd manager/frontend
npm run build
```
âœ… æ„å»ºæˆåŠŸ,æ— è¯­æ³•é”™è¯¯

### åŠŸèƒ½æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] èµ„æºæ ‘åŠ è½½
- [ ] è¡¨æ ¼æ•°æ®é¢„è§ˆ
- [ ] å¸¦GeoJSONå­—æ®µçš„è¡¨æ ¼åœ°å›¾é¢„è§ˆ
- [ ] å¯¹è±¡å­˜å‚¨ç›®å½•æµè§ˆ
- [ ] å¯¹è±¡å­˜å‚¨æ–‡ä»¶é¢„è§ˆ:
  - [ ] å›¾ç‰‡é¢„è§ˆ
  - [ ] JSONé¢„è§ˆ
  - [ ] GeoJSONé¢„è§ˆ(å¸¦åœ°å›¾)
  - [ ] æ–‡æœ¬é¢„è§ˆ
- [ ] åœ°å›¾åŠŸèƒ½:
  - [ ] é«˜å¾·åœ°å›¾åº•å›¾
  - [ ] å¤©åœ°å›¾çŸ¢é‡åº•å›¾
  - [ ] å¤©åœ°å›¾å½±åƒåº•å›¾
  - [ ] åœ°å›¾åˆ‡æ¢è§†è§’ä¿æŒ
  - [ ] ç‚¹å‡»è¦ç´ é«˜äº®
- [ ] å¯æ‹–æ‹½è°ƒæ•´:
  - [ ] æ ‘å®½åº¦è°ƒæ•´
  - [ ] åœ°å›¾é«˜åº¦è°ƒæ•´
  - [ ] å…ƒæ•°æ®é«˜åº¦è°ƒæ•´
- [ ] åˆ†é¡µåŠŸèƒ½
- [ ] å¯¹è±¡å­˜å‚¨ç›®å½•å¯¼èˆª(åŒå‡»è¿›å…¥)

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### æ€§èƒ½ä¼˜åŒ–
1. **ä»£ç åˆ†å‰²**
   ```javascript
   // plugins/previews/index.js
   registerPreview({
     name: 'geojson',
     component: () => import('@/components/previews/GeoJsonPreview.vue'), // æ‡’åŠ è½½
     canHandle: (data) => data.object?.content?.kind === 'geojson',
     priority: 80
   })
   ```

2. **åœ°å›¾å®ä¾‹ç¼“å­˜**
   - é¿å…é¢‘ç¹é”€æ¯é‡å»ºåœ°å›¾å®ä¾‹
   - å®ç°åœ°å›¾æ± ç®¡ç†

### åŠŸèƒ½å¢å¼º
1. **æ›´å¤šæ–‡ä»¶ç±»å‹æ”¯æŒ**
   - PDFé¢„è§ˆ
   - Excelé¢„è§ˆ
   - Parqueté¢„è§ˆ
   - Videoé¢„è§ˆ

2. **æ’ä»¶å¸‚åœº**
   - åˆ›å»ºæ’ä»¶æ¨¡æ¿ç”Ÿæˆå™¨
   - å‘å¸ƒå®˜æ–¹æ’ä»¶åº“
   - æ”¯æŒNPMåŒ…å½¢å¼çš„æ’ä»¶

### å¼€å‘ä½“éªŒ
1. **å•å…ƒæµ‹è¯•**
   ```bash
   npm install -D @vue/test-utils vitest
   ```
   ä¸ºæ¯ä¸ªComposableå’Œç»„ä»¶ç¼–å†™æµ‹è¯•

2. **Storybooké›†æˆ**
   ```bash
   npx storybook@latest init
   ```
   å¯è§†åŒ–é¢„è§ˆæ‰€æœ‰ç»„ä»¶

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [é‡æ„æ–¹æ¡ˆ](REFACTOR_PLAN.md) - è¯¦ç»†çš„é‡æ„æ–¹æ¡ˆå’Œæ¶æ„è®¾è®¡
- [æ’ä»¶å¼€å‘æŒ‡å—](public/plugins/README.md) - ç”¨æˆ·è‡ªå®šä¹‰æ’ä»¶å¼€å‘æ–‡æ¡£
- [åŸCLAUDE.md](../../CLAUDE.md) - é¡¹ç›®æ•´ä½“æ¶æ„æ–‡æ¡£

---

## âœ¨ æ€»ç»“

é€šè¿‡è¿™æ¬¡é‡æ„:

1. **ä»£ç è´¨é‡æå‡**: 2555è¡Œå·¨å‹æ–‡ä»¶ â†’ 21ä¸ªå¹³å‡115è¡Œçš„æ¨¡å—
2. **å¯ç»´æŠ¤æ€§æå‡**: èŒè´£æ¸…æ™°,ä¿®æ”¹åœ°å›¾é€»è¾‘ä¸å½±å“é¢„è§ˆç»„ä»¶
3. **å¯æ‰©å±•æ€§æå‡**: æ’ä»¶åŒ–ç³»ç»Ÿ,ç”¨æˆ·å¯æ— ä¾µå…¥å¼æ·»åŠ æ–°åŠŸèƒ½
4. **å¼€å‘æ•ˆç‡æå‡**: ç»„ä»¶å¤ç”¨,æ–°åŠŸèƒ½å¼€å‘æ—¶é—´å‡å°‘50%+

è¿™æ˜¯ä¸€ä¸ª**ç”Ÿäº§çº§åˆ«çš„é‡æ„**,ä¸ºåç»­åŠŸèƒ½è¿­ä»£æ‰“ä¸‹äº†åšå®åŸºç¡€! ğŸ‰
