本文档是对addp工程的基本设计原则的说明。

addp：All Domain Data Platform，全域数据平台
基于Data Fabric思维、旨在支持所有类型数据进行汇聚、治理、计算、服务和资产管理等在内的平台。


# 总体设计原则
## 单一职责原则
各模块均有自己的职责，其他模块非必要，不得重复建设别的模块范围内的职责。
## 避免重复代码
当遇到类似代码实现时，应该在common等中实现，各模块再予以调用代码。
## 前端复用原则
每个模块都可以独立部署，按照微服务设计。
整个系统有统一的门户，统一门户集成各模块前端，避免重复实现，嵌入时主要不要出现内容重叠。注意采用system的统一认证，避免多次登录要求。


模块包括：
# system，系统管理
## 多租户和用户管理
用户类型分为：超级管理员、租户管理员和普通用户
超级管理员可创建和管理租户，租户采用租户id进行隔离，以后根据实际需要决定是否采用更加严格的隔离措施
租户管理员可创建和管理普通用户
普通用户无权创建其他用户
尚未进行项目组或工作组的划分，看以后需求再定

## 认证管理
所有模块的统一认证和登录，均由system管理，直接调用system完成。其他模块不得自行进行认证工作

## 资源管理
当前仅包括存储引擎（包括但不限于数据库、对象存储等）的链接设置和可用性测试。
后续会增加其他资源类型，如计算引擎（如spark、ray等）、私有容器库、私有代码库、硬件资源等的管理。
其他模块在访问资源时，均直接调用system的接口完成，各模块无需做缓存等，防止信息不同步

# 内置系统存储
所有模块，均采用一套内置的系统存储。当前已使用Postgresql数据库管理结构化数据，后续会根据实际需要增加redis、minio、elasticsearch等内置的系统存储能力。
## 内置系统数据库
内部根据各模块名字划分为不同schema，如system、meta等。
各schema，原则上只能由对应的模块予以写入。
对于读取，则要分情况处理：如用户管理、认证信息、资源管理中的密码等关键内容，只能由system模块进行；
其他内容，则各模块均可以根据需要予以直接读取，避免通过api访问带来的性能损耗。
如meta模块，可以直接读取system schema中资源管理中的条目，但要进行连接时，则必须通过system的接口来进行，因为链接的密码是做过加密的。

# meta模块
meta模块负责所有元数据的统一存储、血缘追踪和基于元数据的检索。
meta模块前端页面包括以下内容：
## 元数据扫描
当点击左侧的“元数据扫描”时，右侧窗口，列出所有存储引擎。
选中一个存储引擎后，列出该存储引擎中的所有schema，可以多选或者全选这些schema，然后再扫描这些schema中的所有表及其字段。
扫描后的元数据，存储到系统数据库的meta schema中，供其他模块后续使用。
除了上述手动扫描，右侧窗口还提供设置自动扫描时间的功能，默认为每晚十二点。
扫描前，对应的schema的状态为“未扫描”；扫描开始后，状态为“扫描中”；扫描结束后，状态为“已扫描”，并标明最后扫描时间。

meta模块前端的其他页面，删除。以后有需要再增加。

# manager模块
## 数据探查
先删除原有全部子模块，增加“数据探查”功能页面。
当选中数据探查时，右侧出现所有system中的存储引擎，并以倒三角的图标方式按层级展开其中的schema和表（已经被meta扫描过的）
在选中一张表后，右侧用表格的方式展示前五十行记录（每页十行，分五页）
